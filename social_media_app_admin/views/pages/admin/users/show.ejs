<%- contentFor('HeaderCss') %>
<link rel="stylesheet" href="/assets/libs/swiper/swiper-bundle.min.css" />

<%- contentFor('body') %>
<div class="profile-foreground position-relative mx-n4 mt-n4">
  <div class="profile-wid-bg">
    <img src="/assets/images/profile-bg.jpg" alt="" class="profile-wid-img" />
  </div>
</div>
<div class="pt-4 mb-4 mb-lg-3 pb-lg-4 profile-wrapper">
  <div class="row g-4">
    <div class="col-auto">
      <% if (user.profile_image) { %>
      <div class="avatar-lg">
        <img
          src="/uploads/users/<%= user.profile_image %>"
          alt="Profile"
          class="avatar-lg rounded-circle img-thumbnail"
        />
      </div>
      <% } else { %>
      <% const initials = (user.name || '').trim().split(/\s+/).map(n => n.charAt(0)).join('').slice(0,2).toUpperCase(); %>
      <div class="avatar-lg">
        <div class="avatar-title rounded-circle bg-white text-primary fw-bold">
          <%= initials || 'U' %>
        </div>
      </div>
      <% } %>
    </div>

    <div class="col">
      <div class="p-2">
        <h3 class="text-white mb-1"><%= user.name %></h3>
        <p class="text-white text-opacity-75">Employee</p>
        <div class="hstack text-white-50 gap-1">
          <div class="me-2">
            <i class="ri-map-pin-user-line me-1 text-white text-opacity-75 fs-16 align-middle"></i>SilverSky
          </div>
          <div>
            <i class="ri-building-line me-1 text-white text-opacity-75 fs-16 align-middle"></i>India
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mt-5">
  <div class="col-lg-12 mt-5 pt-4">
    <div>
      <div class="d-flex profile-wrapper flex-wrap gap-3 align-items-center">
        <ul class="nav nav-pills animation-nav profile-nav gap-2 gap-lg-3 flex-grow-1" role="tablist">
          <li class="nav-item">
            <a class="nav-link fs-14 active" data-bs-toggle="tab" href="#overview-tab" role="tab">
              <i class="ri-airplay-fill d-inline-block d-md-none"></i>
              <span class="d-none d-md-inline-block">Overview</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link fs-14" data-bs-toggle="page" href="/orders/user/<%= user.id %>" role="page">
              <i class="ri-airplay-fill d-inline-block d-md-none"></i>
              <span class="d-none d-md-inline-block">Orders</span>
            </a>
          </li>
        </ul>
        <div class="flex-shrink-0 d-flex gap-2">
          <a href="/admin/users/<%= user.id %>/edit" class="btn btn-success">
            <i class="ri-edit-box-line align-bottom me-1"></i>
            Edit Profile
          </a>
          <a href="mailto:<%= user.email %>" class="btn btn-outline-light text-white">
            <i class="ri-mail-send-line align-bottom me-1"></i>
            Contact
          </a>
        </div>
      </div>

      <div class="tab-content pt-4 text-muted">
        <div class="tab-pane active" id="overview-tab" role="tabpanel">
          <div class="row g-4">
            <div class="col-xxl-4">
              <div class="card shadow-sm mb-4">
                <div class="card-body">
                  <div class="d-flex align-items-center mb-3">
                    <div class="flex-grow-1">
                      <h5 class="card-title mb-1">Profile Overview</h5>
                      <p class="text-muted mb-0">Active since <%= user.createdAt %></p>
                    </div>
                    <span class="badge bg-success-subtle text-success fw-semibold">Verified</span>
                  </div>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item px-0 d-flex align-items-center">
                      <i class="ri-user-line text-primary me-2"></i>
                      <span><strong>Name:</strong> <%= user.name %></span>
                    </li>
                    <li class="list-group-item px-0 d-flex align-items-center">
                      <i class="ri-smartphone-line text-info me-2"></i>
                      <span><strong>Mobile:</strong> <%= user.phoneNumber %></span>
                    </li>
                    <li class="list-group-item px-0 d-flex align-items-center">
                      <i class="ri-mail-line text-warning me-2"></i>
                      <span><strong>Email:</strong> <%= user.email %></span>
                    </li>
                    <li class="list-group-item px-0 d-flex align-items-center">
                      <i class="ri-shield-user-line text-danger me-2"></i>
                      <span><strong>Role:</strong> <%= user.role || 'Customer' %></span>
                    </li>
                  </ul>
                </div>
              </div>

              <div class="card shadow-sm">
                <div class="card-body">
                  <h6 class="text-uppercase fw-semibold text-muted mb-3">Quick Stats</h6>
                  <div class="d-flex flex-wrap gap-3">
                    <div>
                      <p class="text-muted mb-1">Orders</p>
                      <h4 class="mb-0"><%= user.orderCount || 0 %></h4>
                    </div>
                    <div>
                      <p class="text-muted mb-1">Wishlist</p>
                      <h4 class="mb-0"><%= user.wishlistCount || 0 %></h4>
                    </div>
                    <div>
                      <p class="text-muted mb-1">Loyalty Tier</p>
                      <span class="badge bg-primary-subtle text-primary"><%= user.loyaltyTier || 'Standard' %></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-xxl-8">
              <div class="card shadow-sm h-100">
                <div class="card-body"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- contentFor('FooterJs') %>
<script src="/assets/js/user/user-show.js"></script>
<script src="/assets/libs/swiper/swiper-bundle.min.js"></script>
<script src="/assets/js/pages/profile.init.js"></script>
